<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>基因概率计算器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        input, button {
            padding: 10px;
            margin: 5px 0;
            width: 100%;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>基因概率计算器</h1>
        <p>计算父本为 <strong>AA</strong>，母本为 <strong>aa</strong> 的后代自交 <strong>n</strong> 代后的基因型概率。</p>
        <label for="generations">输入代数 (n):</label>
        <input type="number" id="generations" min="1" placeholder="请输入代数">
        <button onclick="calculate()">计算</button>
        <table id="resultTable" style="display: none;">
            <thead>
                <tr>
                    <th>代数 (n)</th>
                    <th>AA 概率</th>
                    <th>Aa 概率</th>
                    <th>aa 概率</th>
                </tr>
            </thead>
            <tbody id="resultBody"></tbody>
        </table>
    </div>

    <script>
        function calculate() {
            const generations = parseInt(document.getElementById("generations").value);
            if (isNaN(generations) || generations < 1) {
                alert("请输入有效的代数 (n >= 1)");
                return;
            }

            // 初始比例
            let pAA = 0; // AA 概率
            let pAa = 1; // Aa 概率
            let paa = 0; // aa 概率

            const resultBody = document.getElementById("resultBody");
            resultBody.innerHTML = ""; // 清空表格内容

            for (let n = 1; n <= generations; n++) {
                // 计算下一代的未归一化比例
                const nextAA = pAA + 0.25 * pAa;
                const nextAa = 0.5 * pAa;
                const nextAaRemoved = nextAA + nextAa; // 去除 aa 后的总比例

                // 归一化
                pAA = nextAA / nextAaRemoved;
                pAa = nextAa / nextAaRemoved;
                paa = 0; // aa 被移除

                // 添加到表格
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${n}</td>
                    <td>${pAA.toFixed(4)}</td>
                    <td>${pAa.toFixed(4)}</td>
                    <td>${paa.toFixed(4)}</td>
                `;
                resultBody.appendChild(row);
            }

            // 显示结果表格
            document.getElementById("resultTable").style.display = "table";
        }
    </script>
</body>
</html>